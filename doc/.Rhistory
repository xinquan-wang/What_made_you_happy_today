barplot(group_B, beside = TRUE)
barplot(group_B, offset = 0, axis.lty = 1, beside = TRUE)
barplot(group_B,  axis.lty = 1, beside = TRUE)
barplot(group_B, axis.lty = 1, beside = TRUE)
barplot(group_B, axis.lty = 0, beside = TRUE)
barplot(group_B, axis.lty = 2, beside = TRUE)
barplot(group_B, axis.lty = 4, beside = TRUE)
barplot(group_B, axis.lty = 1, beside = TRUE)
box()
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, axis.lty = 1, beside = TRUE)
box()
barplot(group_B, axis.lty = 1, beside = TRUE)
barplot(group_B, axis.lty = 1, beside = TRUE)
box()
barplot(group_B, ylim = c(0, max(dataxx) * 1.15), axis.lty = 1, beside = TRUE)
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("topright", legend = legs, fill = cols, box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("topright", legend = c("empirical distribution", "Poisson distribution"), fill = cols, box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("topright", legend = c("empirical distribution", "Poisson distribution"), box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("topright", legend = c("empirical distribution", "Poisson distribution"), fill = c("empirical distribution", "Poisson distribution"),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("topright", legend = c("empirical distribution", "Poisson distribution"), fill = 1:2,
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = 1:2,
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, col = 1:2, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = 1:2,
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = 1:2,
box.col = "transparent")
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = 0:2,
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(1,0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(0.1,0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(0.5,0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(2, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(100, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(256, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(257, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(255, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(256, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(250, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE)
box()
legend("top", legend = c("empirical distribution", "Poisson distribution"), fill = c(251, 0),
box.col = "transparent")
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
n_B
theta_B.mc[1]
n_B
yB.mc <- rpois(n_B, theta_B.mc[1])
yB.mc
sum(yB.mc == 0)
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
t.mc <- c(t.mc, sum(yB.mc == 0) / sum(yB.mc == 1))
}
t.mc <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
t.mc <- c(t.mc, sum(yB.mc == 0) / sum(yB.mc == 1))
}
hist(t.mc)
line(x = sum(nobach == 0) / sum(nobach == 1))
sum(nobach == 0)
hist(t.mc)
line(x = sum(nobach == 0) / sum(nobach == 1))
hist(t.mc)
line(sum(nobach == 0) / sum(nobach == 1))
sum(nobach == 0) / sum(nobach == 1)
hist(t.mc)
sum(nobach == 0) / sum(nobach == 1)
hist(t.mc, xlim = c(0, 1.6))
line(sum(nobach == 0) / sum(nobach == 1))
hist(t.mc, xlim = c(0, 1.6))
hist(t.mc)
hist(t.mc, xlim = c(0, 1.6))
hist(t.mc, xlim = c(0.3, 1.6))
hist(t.mc, xlim = c(0.3, 1.6))
line(sum(nobach == 0) / sum(nobach == 1))
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
n <- 10000
theta_1 <- rbeta(n, 63, 39)
theta_2 <- rbeta(n, 29, 23)
mean(theta_1 > theta_2)
theta_A <- rgamma(n, 237, 20)
theta_B <- rgamma(n, 123, 14)
mean(theta_A > theta_B)
n0 <- seq(1, 100)
theta_A1 <- NULL
theta_B1 <- NULL
prob <- NULL
for (i in 1:length(n0)){
theta_A1 <- rgamma(n, 237, 20)
theta_B1 <- rgamma(n, (12 * n0[i] + 111), (n0[i] + 13))
prob[i] <- mean(theta_A1 > theta_B1)
}
plot(n0, prob, type = "l", main = "Plot of P(thetaA > thetaB|yA, yB) over n0")
theta_A2 <- rgamma(n, 237, 20)
theta_B2 <- rgamma(n, 123, 14)
Y_A <- rpois(n, theta_A2)
Y_B <- rpois(n, theta_B2)
mean(Y_A > Y_B)
theta_A3 <- NULL
theta_B3 <- NULL
prob1 <- NULL
for (i in 1:length(n0)){
theta_A3 <- rgamma(n, 237, 20)
theta_B3 <- rgamma(n, (12 * n0[i] + 111), (n0[i] + 13))
Y_A3 <- rpois(n, theta_A3)
Y_B3 <- rpois(n, theta_B3)
prob1[i] <- mean(Y_A3 > Y_B3)
}
plot(n0, prob1, type = "l", main = "Plot of P(YA > YB|yA, yB) over n0")
y_A <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
meanA <- mean(y_A)
sdA <- sd(y_A)
T_A <- meanA / sdA
nA <- 10
S <- 1000
TA.mc <- NULL
for (i in 1:S){
thetaA <- rgamma(1, 237, 20)
yA <- rpois(nA, thetaA)
TA.mc <- c(TA.mc, mean(yA) / sd(yA))
}
hist(TA.mc)
abline(v = T_A, lty = 2)
hist(t.mc, xlim = c(0.3, 1.6))
abline(v = sum(nobach == 0) / sum(nobach == 1), lty = 2)
hist(t.mc, xlim = c(0.2, 1.6))
hist(t.mc, xlim = c(0.3, 1.6))
abline(v = sum(nobach == 0) / sum(nobach == 1), lty = 2)
count_0 <- NULL
count_1 <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_0, sum(yB.mc == 1))
}
length(count_0)
length(count_1)
n
n <- 5000
n_A <- length(bach)
n
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_0, sum(yB.mc == 1))
}
length(count_1)
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
library(purrr)
bach <- scan("men30bach.txt")
nobach <- scan("men30nobach.txt")
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc)
hist(Y_B.mc)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
count_0 <- NULL
count_1 <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_0, sum(yB.mc == 1))
}
length(count_1)
length(count_0)
count_0 <- NULL
count_1 <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_1, sum(yB.mc == 1))
}
length(count_0)
length(count_1)
plot(count_0, count_1)
plot(count_0, count_1, type = "l")
plot(count_0, count_1, type = "p")
points(sum(nobach == 0), sum(nobach == 1))
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1))
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), col = red)
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = 2)
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "p")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "n")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "o")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "s")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "s", col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1),  col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), type = "s", col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 3, col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 4, col = "red")
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 4)
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 14)
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 19)
count_0 <- NULL
count_1 <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_1, sum(yB.mc == 1))
}
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 19, size = 2)
count_0 <- NULL
count_1 <- NULL
for(i in 1:n){
yB.mc <- rpois(n_B, theta_B.mc[i])
count_0 <- c(count_0, sum(yB.mc == 0))
count_1 <- c(count_1, sum(yB.mc == 1))
}
plot(count_0, count_1)
points(sum(nobach == 0), sum(nobach == 1), pch = 19, size = 1.5)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
library(purrr)
bach <- scan("men30bach.txt")
nobach <- scan("men30nobach.txt")
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc)
hist(Y_B.mc)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
hist(Y_B.mc)
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
library(purrr)
bach <- scan("men30bach.txt")
nobach <- scan("men30nobach.txt")
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc)
hist(Y_B.mc)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
Y_B.mc - Y_A.mc
lenght(Y_B.mc)
length(Y_B.mc)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
Y_A.mc == 7
sum(Y_A.mc == 7)
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc)
sum(Y_A.mc == 6)
sum(Y_A.mc == 5)
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc)
hist(Y_B.mc, breaks = "Sturges")
hist(Y_B.mc, breaks = 0:100)
hist(Y_B.mc, breaks = 0:7)
hist(Y_B.mc)
hist(Y_B.mc, breaks = 0:10)
hist(Y_B.mc, breaks = 1:10)
hist(Y_B.mc, breaks = 0:10)
hist(Y_B.mc, breaks = 10)
hist(Y_B.mc, breaks = 7)
hist(Y_B.mc, breaks = 11)
hist(Y_B.mc, breaks = 5)
hist(Y_B.mc, breaks = 5)
hist(Y_A.mc, breaks = 5)
hist(Y_A.mc, breaks = 10)
hist(Y_A.mc, breaks = 20)
hist(Y_A.mc, breaks = 100)
hist(Y_A.mc, breaks = 10)
hist(Y_A.mc, breaks = 50)
hist(Y_A.mc, breaks = 20)
hist(Y_A.mc, breaks = 30)
hist(Y_B.mc, breaks = 30)
hist(Y_B.mc, breaks = 10)
hist(Y_B.mc, breaks = 20)
hist(Y_B.mc, breaks = 25)
hist(Y_B.mc, breaks = 30)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
hist(tbale(nobach))
hist(table(nobach))
nobach
hist(nobach)
ecdf(nobach)
empirical <- ecdf(nobach)
empirical
nobach
empirical
summary(empirical)
hist(empirical)
plot(empirical)
plot.ecdf(empirical)
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
library(purrr)
bach <- scan("men30bach.txt")
nobach <- scan("men30nobach.txt")
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc, breaks = 30)
hist(Y_B.mc, breaks = 30)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
table(rpois(n_B, 1.4))
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
library(knitr)
opts_chunk$set(echo = FALSE, eval = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55), tidy = TRUE)
library(purrr)
bach <- scan("men30bach.txt")
nobach <- scan("men30nobach.txt")
n <- 5000
n_A <- length(bach)
n_B <- length(nobach)
a <- 2
b <- 1
theta_A.mc <- rgamma(n, a+sum(bach), b+n_A)
theta_B.mc <- rgamma(n, a+sum(nobach), b+n_B)
Y_A.mc <- rpois(n, theta_A.mc)
Y_B.mc <- rpois(n, theta_B.mc)
hist(Y_A.mc, breaks = 30)
hist(Y_B.mc, breaks = 30)
theta_quan <- quantile(theta_B.mc - theta_A.mc, c(0.025, 0.975))
Y_quan <- quantile(Y_B.mc - Y_A.mc, c(0.025, 0.975))
rbind("theta_B - theta_A" = theta_quan, "Y_B - Y_A" = Y_quan)
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
group_B
table(rpois(n_B, 1.4))
table(nobach)
group_B
table(rpois(n_B, 1.4))
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
group_B
group_B <- rbind( "Poisson distribution" = table(rpois(n_B, 1.4))ï¼Œ "empirical distribution" = table(nobach))
group_B <- rbind( "Poisson distribution" = table(rpois(n_B, 1.4)), "empirical distribution" = table(nobach))
group_B
group_B <- rbind( "Poisson distribution" = table(rpois(n_B, 1.4)), "empirical distribution" = table(nobach))
barplot(group_B, ylim = c(0, max(group_B) * 1.15), axis.lty = 1, beside = TRUE,
legend.text = c("empirical distribution", "Poisson distribution"))
box()
group_B <- rbind("empirical distribution" = table(nobach), "Poisson distribution" = table(rpois(n_B, 1.4)))
group_B
